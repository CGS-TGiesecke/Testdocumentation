
=== RAG

==== {application} DMS

Das ist eine SQLight DB Anbindung in {application}, in der systemseitig festgelegte Ordner und vom Kunden leicht zu pflegende Dokumente gespeichert sind.
Die Ordner werden per Script nach Kundenwunsch in der DB erzeugt. Dort sind diese für alle erstmal sichtbar. 
Die erforderlichen Berechtigungen der Rollen auf die Ordner setzt der Kunde selbst.

Die Dateien werden vom Kunden per Hand hochgeladen. 
Die unterstützte Anzahl von Dateien pro Upload beträgt 1000, und die maximale Dateigröße beträgt standardmäßig 5 GB. (Windos Standard) 
Die Berechtigungen auf die einzelnen Dateien entsprechen denen der Verzeichnisse.

==== Sharepoint Andindung über Microsoft Entra ID (ehemals Azure Active Directory) gesicherte API

Die Anbindung von Sharepoint muss über eine API mit den Kundendaten erfolgen. 
In SharePoint werden einzelne Bereiche als Sites bezeichnet. Wenn z.B. eine neue Gruppe in MS Teams erstellt wird, erstellt SharePoint 
automatisch eine entsprechende SharePoint-Site, die mit dieser Gruppe verknüpft ist.

Die notwendigen Daten, für die Anbindung von {application} an Sharepoint des Kunden sind:

* **Tenant-ID:** Die ID des SharePoint-Mandanten, normalerweise eine GUID.
* **Client-ID:** Die Client-ID der SharePoint-Anwendung mit den erforderlichen Berechtigungen (ClientSecrets) für den Datenzugriff.
* **ClientSecrets:** Die SharePoint-Application-Berechtigungen für den Datenzugriff.

Diese werden in einen config file hinterlegt (siehe "Erstkonfiguration der Anwendung"). Sind diese Daten nicht vorhanden, 
muss die Applikation {application} vom Kunden erst in Microsoft Entra ID unter https://kunde.sharepoint.com/sites/ registriert werden.

ifeval::[{big-output} == 1]

===== Registrierung einer Anwendung in Microsoft Entra ID

Dies ist der erste Schritt, wenn eine Applikation die Microsoft Identitätsdienste (z. B. Anmeldung mit Microsoft-Konto, Zugriff auf APIs) verwendet.
Nach der Registrierung kann {application} App Microsoft-Identitätsplattform-Funktionen verwenden (z. B. Anmeldung, Zugriff auf Graph-API usw.).

Wichtige Schritte:

* Anmelden beim Azure-Portal
** Melden Sie sich mit Ihrem Konto und Administratorberechrigungen beim Azure-Portal an. Dort wird die **Tenant-ID** angezeigt.

* App-Registrierungen öffnen
** Navigieren Sie im Menü zu Microsoft Entra ID und wählen Sie dort App-Registrierungen aus.

* Neue Registrierung erstellen
** Klicken Sie auf Neue Registrierung und geben Sie folgende Details an:
*** Name der Anwendung
*** Unterstützte Kontotypen (wer sich bei der App anmelden darf)
*** Umleitungs-URI (optional, für Web-/Mobile-Apps)

* Registrierung abschließen
** Klicken Sie auf Registrieren. Danach erhalten Sie eine Anwendungs-ID (**Client-ID**), mit der Sie die App eindeutig identifizieren können 
und ein Geheimnis (Client Secret) oder Zertifikat.

* Weitere Einstellungen
** Optional können Sie API-Berechtigungen konfigurieren (z.B. Sites.Read.All, Sites.ReadWrite.All), Zertifikate hinzufügen usw., je nach Bedarf der Anwendung.

endif::[]

===== Zugriff auf SharePoint-Inhalte über die Microsoft Graph API

Microsoft Graph API ist die zentrale Schnittstelle, über die programmatisch auf Microsoft 365-Dienste (wie SharePoint) zugegriffen wird.

**Ablauf:**

* OAuth 2.0 Authentifizierung:
** Die Anwendung holt sich über ein sogenanntes OAuth2-Grant-Flow ein Zugriffstoken von Entra ID.

* Aufruf der Graph API:
** Mit dem Token kann die Anwendung SharePoint-Inhalte über die Microsoft Graph API auslesen oder bearbeiten.
