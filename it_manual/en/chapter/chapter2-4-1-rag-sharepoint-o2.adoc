To access SharePoint resources (e.g., lists, sites, files) via a registered application in the Microsoft Entra Admin Center, additional steps are required.

===== Defining SharePoint Permissions

Your application needs the appropriate permissions to access SharePoint Online. This is configured via Microsoft Graph **or** the direct SharePoint API.

*Adding API Permissions*

* Navigate to your app registration:
* Entra Admin Center → Identity → Applications → App registrations → Select your application.
* Click on “API permissions”.
* Add permissions:
** Click on "Add a permission".
** Choose “Microsoft Graph” (recommended for modern access); alternatively: “SharePoint”.
** You can assign Application permissions (for services running without a user context) OR Delegated permissions (in the context of a signed-in user).

*Typical SharePoint permissions with Microsoft Graph:*

Delegated permissions:
```
Sites.Read.All
Sites.ReadWrite.All
```
*Suggestion:* Sites.Read.All

Application permissions:
```
Sites.FullControl.All
Sites.Read.All
Sites.ReadWrite.All
```
*Suggestion:* Sites.Read.All

Typical SharePoint-specific permissions (direct on SharePoint API):
```
AllSites.FullControl
AllSites.Read
AllSites.Write
```
*Suggestion:* AllSites.Read

===== Grant Admin Consent

For your app to work with these permissions, a tenant administrator must approve them:
In API permissions, click "Grant admin consent for [your directory]".

*Important Notes*

"Sites.FullControl.All" or "AllSites.FullControl" grants access to **all** SharePoint content in the tenant.
Only use such permissions with extra caution and only when absolutely necessary!
For production systems, data privacy and security requirements, please consult qualified audit or data protection officers.

===== Accessing SharePoint Content via Microsoft Graph API

The Microsoft Graph API is the central interface for programmatically accessing Microsoft 365 services (such as SharePoint).

*Process:*

* OAuth 2.0 Authentication:
** The application obtains an access token from Entra ID via an OAuth2 grant flow.

* Calling the Graph API:
** With the token, the application can read or modify SharePoint content using the Microsoft Graph API.