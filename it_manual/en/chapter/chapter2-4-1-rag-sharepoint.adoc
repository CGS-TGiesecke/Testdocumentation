
==== Sharepoint Integration via Microsoft Entra ID (formerly Azure Active Directory) secured API

The integration of SharePoint must be performed via an API using customer data.
In SharePoint, individual sections are referred to as Sites. For example, if a new group is created in MS Teams, SharePoint automatically creates the corresponding SharePoint Site, which is linked to this group.

The necessary data for connecting {application} to the customer's SharePoint are:

* **Tenant-ID:** The ID of the SharePoint tenant, usually a GUID.
* **Client-ID:** The client ID of the SharePoint application with the required permissions (Client-Secrets) for data access.
* **Client-Secrets:** The SharePoint application's permissions for data access.

These are stored in a config file (see "Initial Configuration of the Application"). If this data is not available,
the application {application} must first be registered by the customer in Microsoft Entra ID under https://kunde.sharepoint.com/sites/.

ifeval::[{big-output} == 1]

===== Registering an Application in Microsoft Entra ID

Registering an Application in Microsoft Entra ID is the first step when an application uses Microsoft identity services (e.g., Microsoft account login, API access).
After registration, the {application} app can use Microsoft Identity Platform features (e.g., login, access to Graph API).

Important Steps:

* Sign in to the Azure portal
** Sign in with your account and admin privileges to the Azure portal. The **Tenant-ID** will be shown there.

* Open App Registrations
** Navigate to Microsoft Entra ID in the menu and select App registrations.

* Create a New Registration
** Click New registration and enter the following details:
*** Application name
*** Supported account types (who can sign in to the app)
*** Redirect URI (optional, for web/mobile apps)

* Complete Registration
** Click Register. You will then receive an application ID (**Client-ID**) to uniquely identify your app and 
a secret (**Client-Secret**: e.g., Sites.Read.All or Sites.Selected) or a certificate.

* Further settings
** Optionally, you can configure API permissions, add certificates, etc., as needed by your application.

==== Accessing SharePoint Content via the Microsoft Graph API

Microsoft Graph API is the central interface for programmatic access to Microsoft 365 services (such as SharePoint).

**Process:**

* OAuth 2.0 Authentication:
** The application obtains an access token from Entra ID via an OAuth2 grant flow.

* Calling the Graph API:
** With the token, the application can read or modify SharePoint content via the Microsoft Graph API.
